---
layout: post
title: 前端性能优化策略笔记
date: 2021-4-9
categories: blog
tags: [Performance]
author: Mars
pIdentifier: 中文缩进
---

> 记录前端性能优化的方向、方式方法。 

前端性能优化主要方向有：

1. 静态资源优化：html、CSS、JS、图片、字体文件等，包括各种打包压缩策略；
2. 页面渲染策略；
3. 原生APP的优化；
4. 网络性能优化；
5. 研发开发流程优化；
6. 性能监控及评价；

# 静态资源优化
## 一、图片优化
### 1.正确选择图片格式

- jpg、jpeg: 有损储存，适合颜色丰富的照片、彩色图；
- png: 无损储存，体积大，支持透明度，适合透明、线条、图标，边缘清晰，大块同色区域，颜色数少但是需要半通明的场景；
- gif: 8位色，不适合高保真彩色照片，适合动画、图标；
- webp: 现代化格式，可提供有损或无损压缩，最多256色，不适合彩色图片，适合图形和半透明图像；

### 2. 压缩图片体积

- 压缩png图片: node-pngquant-native工具，可在npm安装;
- 压缩jpg图片: jpegtran工具;
- 压缩gif图片: gifsicle工具；

### 3. 根据设备选用不同分辨率的图片

在移动端加载小图片。

### 4. 先采用图片占位符，后续再慢慢加载图片

- 低质量图片占位符LQIP：npm install lqip;
- SVG图像占位符SQIP：npm install sqip;

### 5. 用其他方式代替图片

- Data URI: 比如Base64形式；
- Web Font；
- 雪碧图;

### 6. 服务端图片自动优化

按请求自动裁剪、调节分辨率、AI抠图、质量控制等。

## 二、HTML优化
### 1. 精简HTML代码

- 减少HTML嵌套；
- 减少DOM节点数；
- 减少无语义的代码；
- 压缩：删除注释、多余空格和缩进等；
- 使用相对路径的url；

### 文件放在合适的位置

- CSS引入在头部进行；
- Js引入在末尾进行；

### 增强用户体验

- 始终设置favicon图标；
- 增加首屏必要的CSS和JS：为需要加载的资源设置一个背景色，然后用js控制资源加载完成后去掉，可以减少用于白屏等待的时间。

## 三、CSS优化
### 1. 提升CSS渲染性能

- 谨慎使用耗费计算资源的属性。比如:nth-child,position:fixed定位；
- 减少样式嵌套层数；
- 避免占用CPU过多的属性值：比如left: -99999px;
- 避免复杂动画、透明度转换等；

### 2. CSS文件优化

- 尽量使用外联CSS文件，充分利用浏览器缓存；
- 避免使用@import： 因为CSS中引入@import相当于整合所有CSS文件为一个，必须所有import的CSS文件都加载完成，才能开始渲染，相比于独立文件加载渲染更慢。
- CSS代码压缩；

### 3. 中文字体优化、合理使用Web Fonts

- 中文字体体积太大，使用fontmin对常用3500汉字进行字体裁剪，然后再转换为woff格式，可以大幅缩减字体体积；
- 字体保存在CDN上；
- 字体以Base64形式保存在CSS，并且通过localStorage缓存；
- Google相关服务选择国内托管；




