(()=>{window.addEventListener("load",(()=>{let e=document.querySelectorAll("a");for(let t of e)t.href&&-1===t.href.indexOf("marswiz")&&-1===t.href.indexOf("localhost")&&(t.target="_blank")}));let e=!1;try{let t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}function t(e,t){let n=null;return function(...o){null===n||clearTimeout(n),n=setTimeout((()=>{e(...o),n=null}),1e3*t)}}function n(e,t){let n=0;return function(...o){let r=Date.now();r-n>=1e3*t&&(e(...o),n=r)}}function o(e){let t=e.target.src.replace(/Black/,"Blue");e.target.src=t}function r(e){let t=e.target.src.replace(/Blue/,"Black");e.target.src=t}function l(){document.querySelector("#navBlog").classList.remove("navHidden"),document.querySelector("#navFront").classList.remove("navShown"),document.querySelector("#navFront").classList.add("navHidden"),document.querySelector("#navBlog").classList.add("navShown")}function a(){document.querySelector("#navFront").classList.remove("navHidden"),document.querySelector("#navBlog").classList.remove("navShown"),document.querySelector("#navBlog").classList.add("navHidden"),document.querySelector("#navFront").classList.add("navShown")}function i(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}document.querySelector("#blogBtn img").addEventListener("mouseover",o,!1),document.querySelector("#tagBtn img").addEventListener("mouseover",o,!1),document.querySelector("#aboutMeBtn img").addEventListener("mouseover",o,!1),document.querySelector("#searchBtn img").addEventListener("mouseover",o,!1),document.querySelector("#blogBtn img").addEventListener("mouseout",r,!1),document.querySelector("#tagBtn img").addEventListener("mouseout",r,!1),document.querySelector("#aboutMeBtn img").addEventListener("mouseout",r,!1),document.querySelector("#searchBtn img").addEventListener("mouseout",r,!1),document.querySelector("#logo #blogLogo").addEventListener("mouseover",(function(e){let t=e.target.src.replace(/Black/,"White");e.target.src=t}),!1),document.querySelector("#logo #blogLogo").addEventListener("mouseout",(function(e){let t=e.target.src.replace(/White/,"Black");e.target.src=t}),!1);let s=function(e){return e.wheelDelta||40*-e.detail},d=function(){return i()?"touchmove":"object"==typeof window.onmousewheel?"mousewheel":"DOMMouseScroll"};function c(t){if((-120==s(t)||-150==s(t)||-210==s(t)||i())&&window.innerWidth>=768)return t.preventDefault(),window.scrollTo(0,document.querySelector("#frontShow").offsetHeight),l(),window.removeEventListener(d(),c,!!e&&{passive:!1})}function u(){window.scrollY<=10?window.addEventListener(d(),c,!!e&&{passive:!1}):window.scrollY>10&&window.scrollY<document.querySelector("#frontShow").offsetHeight-30&&(window.scrollTo(0,0),a(),$("#frontPageInfo").hide(),$("#tagBox").hide(),$("#frontPageInfo").slideDown(1500),$("#tagBox").slideDown(500))}function h(){let e=document.querySelectorAll("#postContent a");for(let t=0;t<e.length;t++)e[t].innerHTML=e[t].innerHTML.replace(/^/g,'&nbsp;<i class="fa fa-hand-pointer-o"></i>&nbsp;');let t=document.querySelectorAll("#postContent h1,#postContent h2,#postContent h3,#postContent h4,#postContent h5,#postContent h6");for(let e of t){let t='<span class="link hidden">#</span>';window.innerWidth>768&&(e.innerHTML=t+e.innerHTML),e.addEventListener("mouseover",(t=>{e.firstElementChild.classList.remove("hidden")})),e.addEventListener("mouseout",(t=>{e.firstElementChild.classList.add("hidden")}))}let n=document.querySelectorAll(".tooltip-mars");for(let e=0;e<n.length;e++)n[e].innerHTML=n[e].innerHTML.replace(/^/g,'<i class="fa fa-eye">&nbsp;</i>');let l=document.querySelectorAll("#postBox p"),a=document.querySelector("#pIdentifier")?document.querySelector("#pIdentifier").innerHTML:null;if("英文缩进"==a){for(let e=0;e<l.length;e++)l[e].classList.add("eng");let e=document.querySelectorAll("#postBox blockquote p");for(let t=0;t<e.length;t++)e[t].classList.add("noIndent")}else if("中文缩进"==a){let e=document.querySelectorAll("#postBox blockquote p"),t=document.querySelectorAll("#postBox p");for(let t=0;t<e.length;t++)e[t].classList.add("noIndent");if(window.innerWidth<=768)for(let e=0;e<t.length;e++)1==t[e].childNodes.length&&"CODE"==t[e].childNodes[0].tagName&&(t[e].style.textIndent="0",t[e].style.textAlign="left",t[e].style.wordWrap="break-word")}else if("无缩进"==a)for(let e=0;e<l.length;e++)l[e].classList.add("noIndent");else if("全缩进"==a){for(let e=0;e<l.length;e++)l[e].classList.add("allIndent");let e=document.querySelectorAll("#postBox blockquote p");for(let t=0;t<e.length;t++)e[t].classList.remove("allIndent"),e[t].classList.add("noIndent")}let i=document.querySelectorAll("#postPager img");for(let e=0;e<i.length;e++)i[e].addEventListener("mouseover",o,!1),i[e].addEventListener("mouseout",r,!1);let s=document.querySelectorAll("#postBox img");for(let e=0;e<s.length;e++){s[e].parentNode.style.textIndent="0";let t=s[e].parentNode.offsetWidth,n=s[e].offsetWidth;s[e].style.marginLeft=.45*(t-n)+"px"}function d(e){location.href=document.querySelector("#baseURLIdentifier").innerHTML+"/tags/#"+e.target.innerHTML}let c=document.querySelectorAll("#tagsBox #tags span");if(window.innerWidth>768)for(let e=0;e<c.length;e++)c[e].addEventListener("mousedown",d,!1);else for(let e=0;e<c.length;e++)c[e].addEventListener("touchend",d,!1)}document.querySelector("#frontShow")&&(window.addEventListener("load",n(u,0),!!e&&{passive:!1}),window.addEventListener("scroll",n(u,0),!!e&&{passive:!1})),window.addEventListener("load",h,!1),window.innerWidth<=768&&(window.addEventListener("load",L,!1),$(document).one("touchstart",L)),function(){let e=document.querySelectorAll(".blogYear,#postContent h1,#postContent h2,#postContent h3,#postContent h4,#postContent h5,#postContent h6");function t(e){window.scrollTo(0,e.target.offsetTop-1.2*document.querySelector("#navBlur").offsetHeight)}for(let n=0;n<e.length;n++)e[n].addEventListener("mousedown",t,!1)}(),window.innerWidth>=769&&(document.querySelector("#navBlog").style.display="block"),window.addEventListener("resize",t(B,.5));let g=0,w=0;function v(e){if(w-g>=.2*window.innerWidth&&g>=.1*window.innerWidth){let e=document.querySelectorAll("#navMobile,#navMobile #navBlur,#navMobile #navTrans");for(let t=0;t<e.length;t++)e[t].style.animation="navMove 0.5s ease-in forwards"}else if(w-g<=-.2*window.innerWidth){let e=document.querySelectorAll("#navMobile,#navMobile #navBlur,#navMobile #navTrans");for(let t=0;t<e.length;t++)e[t].style.animation="navMoveBack 0.5s ease-in forwards"}g=0,w=0}function m(e){1==e.touches.length&&(g=e.touches[0].clientX),window.addEventListener("touchend",v,!1)}function f(e){return window.removeEventListener("touchend",v,!1)}function p(e){1==e.changedTouches.length&&(w=e.changedTouches[0].clientX)}function y(e){let t=e.attr("src").replace(/Black/g,"White");return e.attr("src",t),!0}function S(e){let t=e.attr("src").replace(/White/g,"Black");return e.attr("src",t),!0}function L(){if(window.innerWidth<=768)if("Day"!=window.localStorage.marswizBlogDayNight&&window.localStorage.marswizBlogDayNight){$("body,.cloudTag,blockquote,#searchBox").css({backgroundColor:"#506060"}),$("#blogBox #link,#blogs a,.blogYear,.tag,.cloudTag,#tagBlogs a,#aboutMeBox,#aboutMeTitle,#searchBox span,#searchResultList div,#noResultContent p").css({color:"white"}),$("p#frontPostTagsMobile,.cloudTag").css({borderColor:"white"});let e=document.querySelectorAll("#pageNumBox,#changeDayNight,#postBox,.leancloud-visitors,.vat,.vcontent p,.vcontent a,.vwrap,input,textarea,.vinfo,.vinfo .vnum,.vlist,.vcount,div.vctrl,div.vctrl span");for(let t=0;t<e.length;t++)e[t].style.color="white";$("#webInfo,.power a").css("color","#999"),$("path").attr("fill","white"),$("div#socialBall").css({backgroundColor:"#bdb7b1"}),$("div#navBlur").css({backgroundColor:"#506060",boxShadow:"0 0 3px #6cd1ef"}),$("#changeDayNight").attr("class","fa fa-moon-o");for(let e=0;e<$("img").length;e++)y($($("img")[e]));$("pre").css("backgroundColor","#999")}else{$("body,.cloudTag,blockquote,#searchBox").css({backgroundColor:""}),$("#blogBox #link,#blogs a,.blogYear,.tag,.cloudTag,#tagBlogs a,#aboutMeBox,#aboutMeTitle,#searchBox span,#searchResultList div,#noResultContent p").css({color:""}),$("p#frontPostTagsMobile,.cloudTag").css({borderColor:""}),$("#pageNumBox,#changeDayNight").css({color:""}),$("div#socialBall").css({backgroundColor:""}),$("div#navBlur").css({backgroundColor:"",boxShadow:""});let e=document.querySelectorAll("#pageNumBox,#changeDayNight,#postBox,.leancloud-visitors,.vat,.vcontent p,.vcontent a,.vwrap,input,textarea,.vinfo,.vinfo .vnum,.vlist,.vcount,div.vctrl,div.vctrl span");for(let t=0;t<e.length;t++)e[t].style.color="";$("#webInfo,.power a").css("color",""),$("path").attr("fill",""),$("#changeDayNight").attr("class","fa fa-lightbulb-o");for(let e=0;e<$("img").length;e++)S($($("img")[e]));$("pre").css("backgroundColor","")}}function B(){window.innerWidth<=768?(window.addEventListener("touchstart",m,!!e&&{passive:!1}),window.addEventListener("touchend",p,!!e&&{passive:!1}),window.addEventListener("gesturestart",f,!1),document.querySelector("#navBlog").style.display="none"):document.querySelector("#navBlog").style.display="block"}window.innerWidth<=768&&(window.addEventListener("touchstart",m,!1),window.addEventListener("touchend",p,!1),window.addEventListener("gesturestart",f,!1),document.querySelectorAll("pre").forEach((e=>{e.addEventListener("touchend",(e=>{e.stopPropagation()}),!0)}))),$("#changeDayNight").click((function(){window.innerWidth<=768&&(window.localStorage?window.localStorage.marswizBlogDayNight&&"Day"!=window.localStorage.marswizBlogDayNight?window.localStorage.setItem("marswizBlogDayNight","Day"):window.localStorage.setItem("marswizBlogDayNight","Night"):alert("Your Browser Doesn't Support Web Storage. The Function Cannot Be Used."))})),$("#changeDayNight").click(L),window.innerWidth<=768&&window.addEventListener("load",L,!1),window.addEventListener("load",(function(){window.innerWidth>=768&&(document.querySelector("#frontShow")?window.scrollY>=document.querySelector("#frontShow").clientHeight-2?l():(a(),$("#frontPageInfo").slideDown(1500),$("#tagBox").slideDown(500)):(document.querySelector("#navBlog").classList.remove("navHidden"),document.querySelector("#navBlog").classList.add("navShown")))}),!1),window.addEventListener("load",h,!1),window.addEventListener("resize",t(B,.5)),window.addEventListener("keydown",(e=>{e.ctrlKey&&-1!==["s","p"].indexOf(e.key)&&e.preventDefault()})),(()=>{"use strict";new class{constructor(e="body",t="#headerIndexContainer"){this.isStr(t)&&(t=document.querySelector(t)),this.isStr(e)&&(e=document.querySelector(e)),this.container=t,t.classList.add("headerIndexContainer"),this.base=e,this.frag=document.createDocumentFragment(),this.headers=[],this.tags=[0,0,0,0,0,0],this.refreshHeaders()}isStr(e){return"string"==typeof e}getHeaders(e=document,t=1){return this.isStr(e)&&(e=document.querySelector(e)),e.querySelectorAll(`h${t}`)}refreshHeaders(){let e=this.base.querySelectorAll("h1,h2,h3,h4,h5,h6");this.headers.length=0;for(let t of e)this.headers.push({id:t.id,content:t.innerText,level:+t.tagName.slice(1)});this.refreshContainerElement()}refreshContainerElement(){let e=document.createElement("div");e.classList.add("headerIndexInnerContainer");let t=document.createDocumentFragment();for(let e of this.headers)this.addIndexLinkElement(e,t);this.frag=t,e.appendChild(t),this.container.innerHTML="",this.container.appendChild(e)}addIndexLinkElement(e,t=this.frag){let{level:n,content:o,id:r}=e,l=document.createElement("a");l.classList.add(`headerIndex_level_${n}`),this.tags[n-1]+=1;for(let e=n;e<this.tags.length;e++)this.tags[e]=0;let a=this.tags.slice(0,n).join("."),i=document.createElement("span");i.innerText=`${a}  `,i.classList.add("headerIndexTag");let s=document.createElement("span");o=o.replace(/(\d+\.)+\d?\s?/,""),o=o.replace(/\S+、\s/,""),s.innerText=o,l.appendChild(i),l.appendChild(s),l.href=`#${r}`,t.appendChild(l)}}("#postContent","#headerIndex")})()})();